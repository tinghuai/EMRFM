2022-11-18 13:20:43,113 - ============================== Params ==============================
2022-11-18 13:20:43,113 - logger_name: nmfir_MIntRec_multi-class_2022-11-18-13-20-43
2022-11-18 13:20:43,113 - dataset: MIntRec
2022-11-18 13:20:43,113 - data_mode: multi-class
2022-11-18 13:20:43,113 - method: nmfir
2022-11-18 13:20:43,113 - text_backbone: bert-base-uncased
2022-11-18 13:20:43,113 - seed: 0
2022-11-18 13:20:43,113 - num_workers: 0
2022-11-18 13:20:43,113 - gpu_id: 0
2022-11-18 13:20:43,113 - data_path: MIA-datasets
2022-11-18 13:20:43,113 - train: True
2022-11-18 13:20:43,113 - tune: False
2022-11-18 13:20:43,113 - save_model: True
2022-11-18 13:20:43,114 - save_results: True
2022-11-18 13:20:43,114 - log_path: logs
2022-11-18 13:20:43,114 - cache_path: cache
2022-11-18 13:20:43,114 - video_data_path: video_data
2022-11-18 13:20:43,114 - audio_data_path: audio_data
2022-11-18 13:20:43,114 - video_feats_path: video_feats.pkl
2022-11-18 13:20:43,114 - audio_feats_path: audio_feats.pkl
2022-11-18 13:20:43,114 - results_path: results
2022-11-18 13:20:43,114 - output_path: outputs
2022-11-18 13:20:43,114 - model_path: models
2022-11-18 13:20:43,114 - config_file_name: nmfir_bert
2022-11-18 13:20:43,114 - results_file_name: nmfir_bert.csv
2022-11-18 13:20:43,114 - padding_mode: zero
2022-11-18 13:20:43,114 - padding_loc: end
2022-11-18 13:20:43,114 - need_aligned: False
2022-11-18 13:20:43,114 - eval_monitor: f1
2022-11-18 13:20:43,114 - train_batch_size: 6
2022-11-18 13:20:43,114 - eval_batch_size: 6
2022-11-18 13:20:43,114 - test_batch_size: 4
2022-11-18 13:20:43,114 - wait_patience: 4
2022-11-18 13:20:43,114 - num_train_epochs: 100
2022-11-18 13:20:43,114 - use_cmd_sim: False
2022-11-18 13:20:43,114 - reverse_grad_weight: 0.8
2022-11-18 13:20:43,114 - hidden_size: 256
2022-11-18 13:20:43,114 - dropout_rate: 0.1
2022-11-18 13:20:43,115 - diff_weight: 0.7
2022-11-18 13:20:43,115 - sim_weight: 0.7
2022-11-18 13:20:43,115 - recon_weight: 0.6
2022-11-18 13:20:43,115 - lr: 3e-05
2022-11-18 13:20:43,115 - grad_clip: -1.0
2022-11-18 13:20:43,115 - gamma: 0.5
2022-11-18 13:20:43,115 - common_hyper_param: {'common_param': {'padding_mode': 'zero', 'padding_loc': 'end', 'need_aligned': False, 'eval_monitor': 'f1', 'train_batch_size': 6, 'eval_batch_size': 6, 'test_batch_size': 4, 'wait_patience': 4}, 'hyper_param': {'num_train_epochs': 100, 'use_cmd_sim': False, 'reverse_grad_weight': 0.8, 'hidden_size': 256, 'dropout_rate': 0.1, 'diff_weight': 0.7, 'sim_weight': 0.7, 'recon_weight': 0.6, 'lr': 3e-05, 'grad_clip': -1.0, 'gamma': 0.5}}
2022-11-18 13:20:43,115 - pred_output_path: outputs\nmfir_MIntRec_multi-class_2022-11-18-13-20-43
2022-11-18 13:20:43,115 - model_output_path: outputs\nmfir_MIntRec_multi-class_2022-11-18-13-20-43\models
2022-11-18 13:20:43,115 - ============================== End Params ==============================
2022-11-18 13:20:43,118 - Generate Text Features Begin...
2022-11-18 13:21:02,402 - Generate Text Features Finished...
2022-11-18 13:21:02,403 - Load Video Features Begin...
2022-11-18 13:21:02,803 - Load Video Features Finished...
2022-11-18 13:21:03,200 - Load Audio Features Begin...
2022-11-18 13:21:03,927 - Load Audio Features Finished...
2022-11-18 13:21:14,700 - Multimodal intent recognition begins...
2022-11-18 13:21:14,701 - Training begins...
2022-11-18 13:21:29,843 - ***** Epoch: 1: Eval results *****
2022-11-18 13:21:29,845 -   best_eval_score = 0.1037
2022-11-18 13:21:29,845 -   eval_score = 0.1037
2022-11-18 13:21:29,845 -   train_loss = 4.0056
2022-11-18 13:21:40,926 - ***** Epoch: 2: Eval results *****
2022-11-18 13:21:40,926 -   best_eval_score = 0.3833
2022-11-18 13:21:40,926 -   eval_score = 0.3833
2022-11-18 13:21:40,926 -   train_loss = 3.1325
2022-11-18 13:21:51,986 - ***** Epoch: 3: Eval results *****
2022-11-18 13:21:51,986 -   best_eval_score = 0.5296
2022-11-18 13:21:51,986 -   eval_score = 0.5296
2022-11-18 13:21:51,986 -   train_loss = 2.2836
2022-11-18 13:22:03,136 - ***** Epoch: 4: Eval results *****
2022-11-18 13:22:03,136 -   best_eval_score = 0.5548
2022-11-18 13:22:03,138 -   eval_score = 0.5548
2022-11-18 13:22:03,139 -   train_loss = 1.6578
2022-11-18 13:22:14,137 - ***** Epoch: 5: Eval results *****
2022-11-18 13:22:14,137 -   best_eval_score = 0.5709
2022-11-18 13:22:14,137 -   eval_score = 0.5709
2022-11-18 13:22:14,137 -   train_loss = 1.3019
2022-11-18 13:22:24,981 - ***** Epoch: 6: Eval results *****
2022-11-18 13:22:24,981 -   best_eval_score = 0.5817
2022-11-18 13:22:24,981 -   eval_score = 0.5817
2022-11-18 13:22:24,982 -   train_loss = 1.1136
2022-11-18 13:22:35,709 - ***** Epoch: 7: Eval results *****
2022-11-18 13:22:35,710 -   best_eval_score = 0.5838
2022-11-18 13:22:35,710 -   eval_score = 0.5838
2022-11-18 13:22:35,710 -   train_loss = 1.0173
2022-11-18 13:22:46,618 - EarlyStopping counter: 1 out of 4
2022-11-18 13:22:46,618 - ***** Epoch: 8: Eval results *****
2022-11-18 13:22:46,618 -   best_eval_score = 0.5838
2022-11-18 13:22:46,618 -   eval_score = 0.5776
2022-11-18 13:22:46,618 -   train_loss = 0.9798
2022-11-18 13:22:57,326 - EarlyStopping counter: 2 out of 4
2022-11-18 13:22:57,327 - ***** Epoch: 9: Eval results *****
2022-11-18 13:22:57,327 -   best_eval_score = 0.5838
2022-11-18 13:22:57,327 -   eval_score = 0.5836
2022-11-18 13:22:57,327 -   train_loss = 0.9587
2022-11-18 13:23:08,456 - ***** Epoch: 10: Eval results *****
2022-11-18 13:23:08,456 -   best_eval_score = 0.5908
2022-11-18 13:23:08,457 -   eval_score = 0.5908
2022-11-18 13:23:08,457 -   train_loss = 0.9482
2022-11-18 13:23:19,438 - EarlyStopping counter: 1 out of 4
2022-11-18 13:23:19,438 - ***** Epoch: 11: Eval results *****
2022-11-18 13:23:19,438 -   best_eval_score = 0.5908
2022-11-18 13:23:19,438 -   eval_score = 0.5879
2022-11-18 13:23:19,438 -   train_loss = 0.939
2022-11-18 13:23:30,439 - EarlyStopping counter: 2 out of 4
2022-11-18 13:23:30,439 - ***** Epoch: 12: Eval results *****
2022-11-18 13:23:30,440 -   best_eval_score = 0.5908
2022-11-18 13:23:30,440 -   eval_score = 0.587
2022-11-18 13:23:30,440 -   train_loss = 0.9321
2022-11-18 13:23:41,743 - EarlyStopping counter: 3 out of 4
2022-11-18 13:23:41,743 - ***** Epoch: 13: Eval results *****
2022-11-18 13:23:41,743 -   best_eval_score = 0.5908
2022-11-18 13:23:41,743 -   eval_score = 0.5862
2022-11-18 13:23:41,743 -   train_loss = 0.9312
2022-11-18 13:23:53,114 - EarlyStopping counter: 4 out of 4
2022-11-18 13:23:53,114 - ***** Epoch: 14: Eval results *****
2022-11-18 13:23:53,114 -   best_eval_score = 0.5908
2022-11-18 13:23:53,114 -   eval_score = 0.5855
2022-11-18 13:23:53,114 -   train_loss = 0.9281
2022-11-18 13:23:53,114 - EarlyStopping at epoch 14
2022-11-18 13:23:53,114 - Trained models are saved in outputs\nmfir_MIntRec_multi-class_2022-11-18-13-20-43\models
2022-11-18 13:23:53,922 - Training is finished...
2022-11-18 13:23:53,922 - Testing begins...
2022-11-18 13:23:56,589 - ***** Test: Confusion Matrix *****
2022-11-18 13:23:56,593 - [[37  2  0  0  5  0  1  0  0  1  1  0  7  2  0  1  0  0  0  0]
 [ 1 37  0  1  0  1  0  0  0  0  0  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 23  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 7  0  0  0  7  0  2  0  0  0  0  0  5  2  0  0  0  0  0  0]
 [ 0  1  0  0  0 10  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 3  0  0  0  1  0  4  0  2  0  0  0  2  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  1  1  0  1  0  3  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  1  2  1  0  0  0  3  1  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  3  0  0  0  0  0  3  1  1  0  0]
 [ 1  1  0  0  0  1  0  0  0  0 14  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 18  0  0  0  0  0  0  0  0]
 [ 2  2  0  0  0  0  0  0  0  0  0  1 47  3  2  0  0  0  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  1 19  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  3 14  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  9  1  0 10  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  2  3  1  0  0  8  0  0]
 [ 0  1  0  0  0  1  0  0  0  0  0  0  2  0  0  1  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  1  0  0  0  0  0  7]]
2022-11-18 13:23:56,593 - ***** Evaluation results *****
2022-11-18 13:23:56,593 -   acc = 0.6899
2022-11-18 13:23:56,593 -   f1 = 0.6425
2022-11-18 13:23:56,593 -   prec = 0.7019
2022-11-18 13:23:56,593 -   rec = 0.6213
2022-11-18 13:23:56,598 - Testing is finished...
2022-11-18 13:23:56,599 - Multimodal intent recognition is finished...
2022-11-18 13:23:56,599 - Results are saved in results\nmfir_bert.csv
