2022-11-18 18:16:57,000 - ============================== Params ==============================
2022-11-18 18:16:57,001 - logger_name: mag_bert_MIntRec_multi-class_2022-11-18-18-16-56
2022-11-18 18:16:57,001 - dataset: MIntRec
2022-11-18 18:16:57,001 - data_mode: multi-class
2022-11-18 18:16:57,001 - method: mag_bert
2022-11-18 18:16:57,001 - text_backbone: bert-base-uncased
2022-11-18 18:16:57,001 - seed: 0
2022-11-18 18:16:57,001 - num_workers: 0
2022-11-18 18:16:57,001 - gpu_id: 0
2022-11-18 18:16:57,001 - data_path: MIA-datasets
2022-11-18 18:16:57,001 - train: True
2022-11-18 18:16:57,001 - tune: False
2022-11-18 18:16:57,001 - save_model: True
2022-11-18 18:16:57,001 - save_results: True
2022-11-18 18:16:57,001 - log_path: logs
2022-11-18 18:16:57,001 - cache_path: cache
2022-11-18 18:16:57,001 - video_data_path: video_data
2022-11-18 18:16:57,001 - audio_data_path: audio_data
2022-11-18 18:16:57,001 - video_feats_path: video_feats.pkl
2022-11-18 18:16:57,001 - audio_feats_path: audio_feats.pkl
2022-11-18 18:16:57,001 - results_path: results
2022-11-18 18:16:57,001 - output_path: outputs
2022-11-18 18:16:57,001 - model_path: models
2022-11-18 18:16:57,001 - config_file_name: mag_bert
2022-11-18 18:16:57,001 - results_file_name: mag_bert.csv
2022-11-18 18:16:57,001 - padding_mode: zero
2022-11-18 18:16:57,001 - padding_loc: end
2022-11-18 18:16:57,001 - need_aligned: True
2022-11-18 18:16:57,001 - eval_monitor: f1
2022-11-18 18:16:57,001 - train_batch_size: 6
2022-11-18 18:16:57,001 - eval_batch_size: 6
2022-11-18 18:16:57,001 - test_batch_size: 4
2022-11-18 18:16:57,001 - wait_patience: 4
2022-11-18 18:16:57,001 - num_train_epochs: 100
2022-11-18 18:16:57,001 - beta_shift: 0.005
2022-11-18 18:16:57,001 - dropout_prob: 0.5
2022-11-18 18:16:57,001 - warmup_proportion: 0.1
2022-11-18 18:16:57,001 - lr: 2e-05
2022-11-18 18:16:57,002 - aligned_method: ctc
2022-11-18 18:16:57,002 - weight_decay: 0.03
2022-11-18 18:16:57,002 - common_hyper_param: {'common_param': {'padding_mode': 'zero', 'padding_loc': 'end', 'need_aligned': True, 'eval_monitor': 'f1', 'train_batch_size': 6, 'eval_batch_size': 6, 'test_batch_size': 4, 'wait_patience': 4}, 'hyper_param': {'num_train_epochs': 100, 'beta_shift': 0.005, 'dropout_prob': 0.5, 'warmup_proportion': 0.1, 'lr': 2e-05, 'aligned_method': 'ctc', 'weight_decay': 0.03}}
2022-11-18 18:16:57,002 - pred_output_path: outputs\mag_bert_MIntRec_multi-class_2022-11-18-18-16-56
2022-11-18 18:16:57,002 - model_output_path: outputs\mag_bert_MIntRec_multi-class_2022-11-18-18-16-56\models
2022-11-18 18:16:57,002 - ============================== End Params ==============================
2022-11-18 18:16:57,005 - Generate Text Features Begin...
2022-11-18 18:17:12,754 - Generate Text Features Finished...
2022-11-18 18:17:12,755 - Load Video Features Begin...
2022-11-18 18:17:13,180 - Load Video Features Finished...
2022-11-18 18:17:13,570 - Load Audio Features Begin...
2022-11-18 18:17:14,298 - Load Audio Features Finished...
2022-11-18 18:17:31,450 - Multimodal intent recognition begins...
2022-11-18 18:17:31,451 - Training begins...
2022-11-18 18:17:44,789 - ***** Epoch: 1: Eval results *****
2022-11-18 18:17:44,796 -   train_loss = 2.926
2022-11-18 18:17:44,796 -   best_eval_score = 0.0
2022-11-18 18:17:44,796 -   eval_score = 0.0103
2022-11-18 18:17:56,735 - ***** Epoch: 2: Eval results *****
2022-11-18 18:17:56,736 -   train_loss = 2.862
2022-11-18 18:17:56,736 -   best_eval_score = 0.0103
2022-11-18 18:17:56,736 -   eval_score = 0.0119
2022-11-18 18:18:08,734 - ***** Epoch: 3: Eval results *****
2022-11-18 18:18:08,734 -   train_loss = 2.736
2022-11-18 18:18:08,734 -   best_eval_score = 0.0119
2022-11-18 18:18:08,734 -   eval_score = 0.1569
2022-11-18 18:18:20,618 - ***** Epoch: 4: Eval results *****
2022-11-18 18:18:20,618 -   train_loss = 2.4604
2022-11-18 18:18:20,618 -   best_eval_score = 0.1569
2022-11-18 18:18:20,618 -   eval_score = 0.2686
2022-11-18 18:18:32,491 - ***** Epoch: 5: Eval results *****
2022-11-18 18:18:32,491 -   train_loss = 2.1362
2022-11-18 18:18:32,493 -   best_eval_score = 0.2686
2022-11-18 18:18:32,493 -   eval_score = 0.2713
2022-11-18 18:18:44,378 - ***** Epoch: 6: Eval results *****
2022-11-18 18:18:44,378 -   train_loss = 1.8029
2022-11-18 18:18:44,378 -   best_eval_score = 0.2713
2022-11-18 18:18:44,378 -   eval_score = 0.3497
2022-11-18 18:18:56,279 - ***** Epoch: 7: Eval results *****
2022-11-18 18:18:56,279 -   train_loss = 1.5559
2022-11-18 18:18:56,279 -   best_eval_score = 0.3497
2022-11-18 18:18:56,279 -   eval_score = 0.4112
2022-11-18 18:19:08,224 - ***** Epoch: 8: Eval results *****
2022-11-18 18:19:08,225 -   train_loss = 1.3271
2022-11-18 18:19:08,225 -   best_eval_score = 0.4112
2022-11-18 18:19:08,225 -   eval_score = 0.5052
2022-11-18 18:19:19,991 - ***** Epoch: 9: Eval results *****
2022-11-18 18:19:19,991 -   train_loss = 1.1207
2022-11-18 18:19:19,991 -   best_eval_score = 0.5052
2022-11-18 18:19:19,991 -   eval_score = 0.5567
2022-11-18 18:19:31,967 - ***** Epoch: 10: Eval results *****
2022-11-18 18:19:31,967 -   train_loss = 0.9295
2022-11-18 18:19:31,967 -   best_eval_score = 0.5567
2022-11-18 18:19:31,967 -   eval_score = 0.5699
2022-11-18 18:19:44,183 - ***** Epoch: 11: Eval results *****
2022-11-18 18:19:44,183 -   train_loss = 0.7599
2022-11-18 18:19:44,183 -   best_eval_score = 0.5699
2022-11-18 18:19:44,183 -   eval_score = 0.6292
2022-11-18 18:19:56,183 - ***** Epoch: 12: Eval results *****
2022-11-18 18:19:56,184 -   train_loss = 0.5999
2022-11-18 18:19:56,184 -   best_eval_score = 0.6292
2022-11-18 18:19:56,184 -   eval_score = 0.6501
2022-11-18 18:20:08,142 - ***** Epoch: 13: Eval results *****
2022-11-18 18:20:08,142 -   train_loss = 0.4625
2022-11-18 18:20:08,142 -   best_eval_score = 0.6501
2022-11-18 18:20:08,142 -   eval_score = 0.6186
2022-11-18 18:20:08,142 - EarlyStopping counter: 1 out of 4
2022-11-18 18:20:21,394 - ***** Epoch: 14: Eval results *****
2022-11-18 18:20:21,394 -   train_loss = 0.37
2022-11-18 18:20:21,394 -   best_eval_score = 0.6501
2022-11-18 18:20:21,394 -   eval_score = 0.6186
2022-11-18 18:20:21,394 - EarlyStopping counter: 2 out of 4
2022-11-18 18:20:34,523 - ***** Epoch: 15: Eval results *****
2022-11-18 18:20:34,523 -   train_loss = 0.28
2022-11-18 18:20:34,523 -   best_eval_score = 0.6501
2022-11-18 18:20:34,523 -   eval_score = 0.635
2022-11-18 18:20:34,523 - EarlyStopping counter: 3 out of 4
2022-11-18 18:20:47,235 - ***** Epoch: 16: Eval results *****
2022-11-18 18:20:47,235 -   train_loss = 0.2148
2022-11-18 18:20:47,235 -   best_eval_score = 0.6501
2022-11-18 18:20:47,235 -   eval_score = 0.6479
2022-11-18 18:20:47,235 - EarlyStopping counter: 4 out of 4
2022-11-18 18:20:47,235 - EarlyStopping at epoch 16
2022-11-18 18:20:47,235 - Trained models are saved in outputs\mag_bert_MIntRec_multi-class_2022-11-18-18-16-56\models
2022-11-18 18:20:47,969 - Training is finished...
2022-11-18 18:20:47,969 - Testing begins...
2022-11-18 18:20:50,344 - ***** Test: Confusion Matrix *****
2022-11-18 18:20:50,360 - [[42  1  0  0  6  0  0  0  0  2  1  0  3  2  0  0  0  0  0  0]
 [ 0 37  0  1  0  2  0  0  0  0  0  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  0  0  0 11  0  0  0  0  0  0  1  1  1  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  1  0  0  3  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  1  0  0  0  0  0  2  0  1  0  0  1  0  0  1  1  0  0  0]
 [ 4  2  0  0  0  0  0  1  1  0  0  0  1  0  0  0  0  0  0  1]
 [ 1  0  0  0  2  0  0  0  0  2  0  0  0  0  0  3  1  1  0  0]
 [ 1  1  0  0  0  0  0  0  0  0 15  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  0 16  0  0  0  0  0  0  0  1]
 [ 6  3  0  0  0  0  0  0  0  0  0  0 37  3  5  0  3  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  0  1  1  0 20  1  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  2  3 14  0  1  0  0  1]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  5  0  1 10  0  0  0  0]
 [ 0  0  0  1  0  0  0  0  0  0  0  0  3  0  2  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  1  0  0  7]]
2022-11-18 18:20:50,360 - ***** Evaluation results *****
2022-11-18 18:20:50,360 -   acc = 0.6944
2022-11-18 18:20:50,360 -   f1 = 0.6331
2022-11-18 18:20:50,360 -   prec = 0.6945
2022-11-18 18:20:50,360 -   rec = 0.6328
2022-11-18 18:20:50,360 - Testing is finished...
2022-11-18 18:20:50,360 - Multimodal intent recognition is finished...
2022-11-18 18:20:50,360 - Results are saved in results\mag_bert.csv
