2023-03-13 21:12:06,346 - ============================== Params ==============================
2023-03-13 21:12:06,346 - logger_name: nmfir_MIntRec_multi-class_2023-03-13-21-12-06
2023-03-13 21:12:06,346 - dataset: MIntRec
2023-03-13 21:12:06,346 - data_mode: multi-class
2023-03-13 21:12:06,346 - method: nmfir
2023-03-13 21:12:06,346 - text_backbone: bert-base-uncased
2023-03-13 21:12:06,346 - seed: 0
2023-03-13 21:12:06,346 - num_workers: 0
2023-03-13 21:12:06,346 - gpu_id: 0
2023-03-13 21:12:06,346 - data_path: MIA-datasets
2023-03-13 21:12:06,346 - train: True
2023-03-13 21:12:06,346 - tune: False
2023-03-13 21:12:06,346 - save_model: True
2023-03-13 21:12:06,346 - save_results: True
2023-03-13 21:12:06,347 - log_path: logs
2023-03-13 21:12:06,347 - cache_path: cache
2023-03-13 21:12:06,347 - video_data_path: video_data
2023-03-13 21:12:06,347 - audio_data_path: audio_data
2023-03-13 21:12:06,347 - video_feats_path: video_feats.pkl
2023-03-13 21:12:06,347 - audio_feats_path: audio_feats.pkl
2023-03-13 21:12:06,347 - results_path: results
2023-03-13 21:12:06,347 - output_path: outputs
2023-03-13 21:12:06,347 - model_path: models
2023-03-13 21:12:06,347 - config_file_name: nmfir_bert
2023-03-13 21:12:06,347 - results_file_name: nmfir_bert.csv
2023-03-13 21:12:06,347 - padding_mode: zero
2023-03-13 21:12:06,347 - padding_loc: end
2023-03-13 21:12:06,347 - need_aligned: False
2023-03-13 21:12:06,347 - eval_monitor: f1
2023-03-13 21:12:06,347 - train_batch_size: 6
2023-03-13 21:12:06,347 - eval_batch_size: 6
2023-03-13 21:12:06,347 - test_batch_size: 4
2023-03-13 21:12:06,347 - wait_patience: 4
2023-03-13 21:12:06,347 - num_train_epochs: 100
2023-03-13 21:12:06,347 - use_cmd_sim: False
2023-03-13 21:12:06,347 - reverse_grad_weight: 0.8
2023-03-13 21:12:06,347 - hidden_size: 256
2023-03-13 21:12:06,347 - dropout_rate: 0.1
2023-03-13 21:12:06,347 - diff_weight: 0.2
2023-03-13 21:12:06,347 - sim_weight: 0.5
2023-03-13 21:12:06,347 - recon_weight: 0.5
2023-03-13 21:12:06,347 - lr: 3e-05
2023-03-13 21:12:06,347 - grad_clip: -1.0
2023-03-13 21:12:06,347 - gamma: 0.5
2023-03-13 21:12:06,347 - common_hyper_param: {'common_param': {'padding_mode': 'zero', 'padding_loc': 'end', 'need_aligned': False, 'eval_monitor': 'f1', 'train_batch_size': 6, 'eval_batch_size': 6, 'test_batch_size': 4, 'wait_patience': 4}, 'hyper_param': {'num_train_epochs': 100, 'use_cmd_sim': False, 'reverse_grad_weight': 0.8, 'hidden_size': 256, 'dropout_rate': 0.1, 'diff_weight': 0.2, 'sim_weight': 0.5, 'recon_weight': 0.5, 'lr': 3e-05, 'grad_clip': -1.0, 'gamma': 0.5}}
2023-03-13 21:12:06,347 - pred_output_path: outputs\nmfir_MIntRec_multi-class_2023-03-13-21-12-06
2023-03-13 21:12:06,347 - model_output_path: outputs\nmfir_MIntRec_multi-class_2023-03-13-21-12-06\models
2023-03-13 21:12:06,347 - ============================== End Params ==============================
2023-03-13 21:12:06,351 - Generate Text Features Begin...
2023-03-13 21:12:37,939 - Generate Text Features Finished...
2023-03-13 21:12:37,939 - Load Video Features Begin...
2023-03-13 21:12:38,873 - Load Video Features Finished...
2023-03-13 21:12:39,481 - Load Audio Features Begin...
2023-03-13 21:12:40,528 - Load Audio Features Finished...
2023-03-13 21:13:05,201 - Multimodal intent recognition begins...
2023-03-13 21:13:05,204 - Training begins...
2023-03-13 21:13:50,914 - ***** Epoch: 1: Eval results *****
2023-03-13 21:13:50,922 -   best_eval_score = 0.3748
2023-03-13 21:13:50,922 -   eval_score = 0.3748
2023-03-13 21:13:50,922 -   train_loss = 3.054
2023-03-13 21:14:28,660 - ***** Epoch: 2: Eval results *****
2023-03-13 21:14:28,660 -   best_eval_score = 0.6075
2023-03-13 21:14:28,660 -   eval_score = 0.6075
2023-03-13 21:14:28,660 -   train_loss = 1.7161
2023-03-13 21:15:05,008 - ***** Epoch: 3: Eval results *****
2023-03-13 21:15:05,008 -   best_eval_score = 0.657
2023-03-13 21:15:05,008 -   eval_score = 0.657
2023-03-13 21:15:05,008 -   train_loss = 1.1567
2023-03-13 21:15:41,075 - EarlyStopping counter: 1 out of 4
2023-03-13 21:15:41,075 - ***** Epoch: 4: Eval results *****
2023-03-13 21:15:41,082 -   best_eval_score = 0.657
2023-03-13 21:15:41,082 -   eval_score = 0.6324
2023-03-13 21:15:41,082 -   train_loss = 0.9024
2023-03-13 21:16:17,734 - ***** Epoch: 5: Eval results *****
2023-03-13 21:16:17,734 -   best_eval_score = 0.67
2023-03-13 21:16:17,734 -   eval_score = 0.67
2023-03-13 21:16:17,734 -   train_loss = 0.7495
2023-03-13 21:16:54,283 - ***** Epoch: 6: Eval results *****
2023-03-13 21:16:54,283 -   best_eval_score = 0.6718
2023-03-13 21:16:54,283 -   eval_score = 0.6718
2023-03-13 21:16:54,283 -   train_loss = 0.6766
2023-03-13 21:17:30,552 - ***** Epoch: 7: Eval results *****
2023-03-13 21:17:30,552 -   best_eval_score = 0.6735
2023-03-13 21:17:30,552 -   eval_score = 0.6735
2023-03-13 21:17:30,552 -   train_loss = 0.6433
2023-03-13 21:18:13,776 - ***** Epoch: 8: Eval results *****
2023-03-13 21:18:13,776 -   best_eval_score = 0.6798
2023-03-13 21:18:13,776 -   eval_score = 0.6798
2023-03-13 21:18:13,776 -   train_loss = 0.6196
2023-03-13 21:18:57,880 - ***** Epoch: 9: Eval results *****
2023-03-13 21:18:57,881 -   best_eval_score = 0.6812
2023-03-13 21:18:57,881 -   eval_score = 0.6812
2023-03-13 21:18:57,881 -   train_loss = 0.6081
2023-03-13 21:19:39,321 - EarlyStopping counter: 1 out of 4
2023-03-13 21:19:39,321 - ***** Epoch: 10: Eval results *****
2023-03-13 21:19:39,322 -   best_eval_score = 0.6812
2023-03-13 21:19:39,322 -   eval_score = 0.6771
2023-03-13 21:19:39,322 -   train_loss = 0.5984
2023-03-13 21:20:20,240 - ***** Epoch: 11: Eval results *****
2023-03-13 21:20:20,240 -   best_eval_score = 0.6826
2023-03-13 21:20:20,241 -   eval_score = 0.6826
2023-03-13 21:20:20,241 -   train_loss = 0.5811
2023-03-13 21:20:58,215 - ***** Epoch: 12: Eval results *****
2023-03-13 21:20:58,215 -   best_eval_score = 0.6854
2023-03-13 21:20:58,215 -   eval_score = 0.6854
2023-03-13 21:20:58,215 -   train_loss = 0.5772
2023-03-13 21:21:38,471 - EarlyStopping counter: 1 out of 4
2023-03-13 21:21:38,471 - ***** Epoch: 13: Eval results *****
2023-03-13 21:21:38,471 -   best_eval_score = 0.6854
2023-03-13 21:21:38,471 -   eval_score = 0.6811
2023-03-13 21:21:38,471 -   train_loss = 0.5771
2023-03-13 21:22:18,655 - EarlyStopping counter: 2 out of 4
2023-03-13 21:22:18,655 - ***** Epoch: 14: Eval results *****
2023-03-13 21:22:18,655 -   best_eval_score = 0.6854
2023-03-13 21:22:18,655 -   eval_score = 0.6842
2023-03-13 21:22:18,655 -   train_loss = 0.5772
2023-03-13 21:22:59,949 - EarlyStopping counter: 3 out of 4
2023-03-13 21:22:59,949 - ***** Epoch: 15: Eval results *****
2023-03-13 21:22:59,949 -   best_eval_score = 0.6854
2023-03-13 21:22:59,949 -   eval_score = 0.6842
2023-03-13 21:22:59,949 -   train_loss = 0.5775
2023-03-13 21:23:40,073 - EarlyStopping counter: 4 out of 4
2023-03-13 21:23:40,073 - ***** Epoch: 16: Eval results *****
2023-03-13 21:23:40,073 -   best_eval_score = 0.6854
2023-03-13 21:23:40,073 -   eval_score = 0.684
2023-03-13 21:23:40,073 -   train_loss = 0.579
2023-03-13 21:23:40,073 - EarlyStopping at epoch 16
2023-03-13 21:23:40,073 - Trained models are saved in outputs\nmfir_MIntRec_multi-class_2023-03-13-21-12-06\models
2023-03-13 21:23:41,338 - Training is finished...
2023-03-13 21:23:41,338 - Testing begins...
2023-03-13 21:23:45,302 - ***** Test: Confusion Matrix *****
2023-03-13 21:23:45,310 - [[34  2  0  0  8  0  2  1  1  3  0  0  6  0  0  0  0  0  0  0]
 [ 0 38  0  1  0  0  3  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 12  0  3  0  0  0  0  1  1  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  1  0  3  0  0  1  1  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  4  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  2  4  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  1  0  0  0  0  3  0  2  0  0]
 [ 1  0  0  0  0  0  0  1  0  1 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  1  0  1  1  0  2  1  0  0  0  2 37  4  3  1  0  0  0  1]
 [ 0  1  0  0  0  0  2  0  0  0  2  1  0 17  1  0  0  0  0  1]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  2  2 15  0  1  0  0  1]
 [ 0  1  0  1  0  0  0  0  1  0  0  0  6  0  0 11  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  0  7]]
2023-03-13 21:23:45,311 - ***** Evaluation results *****
2023-03-13 21:23:45,311 -   acc = 0.7011
2023-03-13 21:23:45,311 -   f1 = 0.6755
2023-03-13 21:23:45,311 -   prec = 0.6836
2023-03-13 21:23:45,311 -   rec = 0.6721
2023-03-13 21:23:45,323 - Testing is finished...
2023-03-13 21:23:45,324 - Multimodal intent recognition is finished...
2023-03-13 21:23:45,324 - Results are saved in results\nmfir_bert.csv
